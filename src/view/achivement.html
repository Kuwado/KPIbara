<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KPIbara</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="/src/css/styles.css">
    <link rel="stylesheet" href="/src/css/achivement.css">

</head>

<body>
    <!----------------------------------------------Start header---------------------------------------------->
    <header class="container-fluid header">
        <div id="sidebar">
            <a href="/src/view/home.html" class="sidebar-item active"><i class="fa-solid fa-house"></i></a>
            <a href="/src/view/viewkpi.html" class="sidebar-item" id="kpi"><i class="fa-solid fa-chart-simple"></i></a>
            <a href="/src/view/task.html" class="sidebar-item"><i class="fa-solid fa-list-check"></i></a>
            <a href="/src/view/achivement.html" class="sidebar-item"><i class="fa-solid fa-trophy"></i></a>
        </div>

        <div id="left-header">
            <div id="logo">
                <img src="/src/images/logo.png">
            </div>
            <div id="menu">
                <a href="/src/view/home.html" class="menu-item active"><i class="fa-solid fa-house"></i><span>Trang chủ</span></a>
                <div class="position-relative">                
                    <a href="/src/view/viewkpi.html" class="menu-item" id="kpi"><i class="fa-solid fa-chart-simple"></i><span>KPI</span></a>
                    <ul class="kpi-list">
                        <li><a href="/src/view/viewkpi.html"><i class="fa-solid fa-clipboard-list"></i><span>Danh sách KPI</span></a></li>
                        <li><a href="/src/view/makekpi.html"><i class="fa-solid fa-plus"></i><span>Thiết lập KPI</span></a></li>
                    </ul>
                </div>
                <a href="/src/view/task.html" class="menu-item"><i class="fa-solid fa-list-check"></i><span>Công việc</span></a>
                <a href="/src/view/achivement.html" class="menu-item"><i class="fa-solid fa-trophy"></i><span>Thành tựu</span></a>
            </div>
        </div>

        <div id="right-header">
            <button class="right-item btn right-icon"><i class="fa-solid fa-circle-question"></i></button>
            <div class="position-relative right-icon">
                <button class="right-item btn position-relative notice-btn" onclick="showNotice()">
                    <i class="fa-solid fa-bell"></i>
                    <span class="position-absolute translate-middle badge bg-primary" id="notice-number">12</span>
                </button>
                <div id="notice">
                    <div id="notice-list">
                        <a href="#"><i class="fa-solid fa-clock"></i><span>Còn 5 phút nữa tới giờ thực hiện "Chạy bộ"</span></a>
                        <a href="#"><i class="fa-solid fa-circle-check"></i><span>Chúc mừng bạn đã hoàn thành xong kpi "Haha"</span></a>
                        <a href="#"><i class="fa-solid fa-circle-exclamation"></i><span>Bạn đã không thực hiện "Học UxUi"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-clock"></i><span>Còn 5 phút nữa tới giờ thực hiện "Chạy bộ"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-circle-check"></i><span>Chúc mừng bạn đã hoàn thành xong kpi "Haha"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-circle-exclamation"></i><span>Bạn đã không thực hiện "Học UxUi"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-clock"></i><span>Còn 5 phút nữa tới giờ thực hiện "Chạy bộ"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-circle-check"></i><span>Chúc mừng bạn đã hoàn thành xong kpi "Haha"</span></a>
                        <a href="#"><i class="fa-solid fa-circle-exclamation"></i><span>Bạn đã không thực hiện "Học UxUi"</span></a>
                        <a href="#"><i class="fa-solid fa-clock"></i><span>Còn 5 phút nữa tới giờ thực hiện "Chạy bộ"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-circle-check"></i><span>Chúc mừng bạn đã hoàn thành xong kpi "Haha"</span></a>
                        <a href="#"><i class="fa-solid fa-circle-exclamation"></i><span>Bạn đã không thực hiện "Học UxUi"</span></a>
                        <a href="#"><i class="fa-solid fa-clock"></i><span>Còn 5 phút nữa tới giờ thực hiện "Chạy bộ"</span></a>
                        <a href="#" class="active"><i class="fa-solid fa-circle-check"></i><span>Chúc mừng bạn đã hoàn thành xong kpi "Haha"</span></a>
                        <a href="#"><i class="fa-solid fa-circle-exclamation"></i><span>Bạn đã không thực hiện "Học UxUi"</span></a>
                    </div>
                </div>
            </div>

            <button class="right-item position-relative" id="avatar" onclick="showAvatarMenu()"><img id="avatar-img" src="/src/images/avatar.jpg"></button>
            <ul id="avatar-menu">
                <li class="avatar-menu-item" id="preview-profile">
                    <img src="/src/images/avatar.jpg">
                    <div id="preview-infor">
                        <span>Lưu Việt Hoàn</span>
                        <span>viethoan557723@gmail.com</span>
                    </div>
                </li>
                <li class="avatar-menu-item"><a href="/src/view/profile.html"><i class="fa-solid fa-user"></i><span>Thông tin cá nhân</span></a></li>
                <li class="avatar-menu-item"><a href="/src/view/setting.html"><i class="fa-solid fa-gear"></i><span>Cài đặt</span></a></li>
                <li class="avatar-menu-item"><a href="/src/view/feedback.html"><i class="fa-solid fa-message"></i><span>Góp ý nhà phát triển</span></a></li>
                <li class="avatar-menu-item"><a href="/src/view/login.html"><i class="fa-solid fa-right-from-bracket"></i><span>Đăng xuất</span></a></li>
            </ul>
        </div>
    </header>
    <!---------------------------------------------End Header------------------------------------------------->

    <!-------------------------------------------------Start main---------------------------------------------->
    <main>
        <div class="kpi-overview">
            <div class="chart1">
                <div class="chart1-header">
                    <p>Biểu đồ tiến độ hoàn thành KPI</p>
                    <div class="next-prev-button">
                        <button id="prevButton"><i class="fa-solid fa-arrow-left"></i></i></button>
                        <button id="nextButton"><i class="fa-solid fa-arrow-right"></i></button>
                    </div>
                </div>
                <canvas id="kpi-chart"></canvas>
            </div>
            <div class="chart2">
                <canvas id="kpi-chart2"></canvas>
            </div>
        </div>
    </main>
    <!--------------------------------------------------End main----------------------------------------------->

    <!-------------------------------------------------Start footer-------------------------------------------->
    <footer>


    </footer>
    <!---------------------------------------------------End footer-------------------------------------------->

    <!-----------------------------------------------------Start Script---------------------------------------->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/78f639c5ca.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Giả sử mảng kpiData chứa dữ liệu cho các KPI
        var kpiData = [
        { kpiName: 'KPI 1', value: 10 },
        { kpiName: 'KPI 2', value: 7 },
        { kpiName: 'KPI 3', value: 5 },
        { kpiName: 'KPI 4', value: 8 },
        { kpiName: 'KPI 5', value: 6 },
        { kpiName: 'KPI 7', value: 10 },
        { kpiName: 'KPI 6', value: 7 },
        { kpiName: 'KPI 8', value: 5 },
        { kpiName: 'KPI 9', value: 8 },
        { kpiName: 'KPI 10', value: 6 },
        // Thêm nhiều KPI khác nếu cần
        ];

        // Khởi tạo biến để theo dõi vị trí hiện tại
        var currentIndex = 0;

        // Hàm để cập nhật biểu đồ
        function updateChart(chart, data) {
        chart.data.labels = data.map(item => item.kpiName);
        chart.data.datasets.forEach((dataset) => {
            dataset.data = data.map(item => item.value);
        });
        chart.update();
        }

        // Hàm để lấy 5 KPI tiếp theo hoặc trước
        function getKpiSlice(index) {
        return kpiData.slice(index, index + 5);
        }

        // Tạo biểu đồ khi trang web tải xong
        document.addEventListener('DOMContentLoaded', function() {
        var ctx = document.getElementById('kpi-chart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
            labels: kpiData.slice(currentIndex, currentIndex + 5).map(item => item.kpiName),
            datasets: [{
                label: 'Giá trị KPI',
                data: kpiData.slice(currentIndex, currentIndex + 5).map(item => item.value),
                backgroundColor: 'rgba(234,76,137, 0.5)',
                borderColor: 'rgba(234,76,137, 1)',
                borderWidth: 1
            }]
            },
            options: {
            scales: {
                yAxes: [{
                ticks: {
                    beginAtZero: true
                }
                }]
            }
            }
        });

        // Thêm sự kiện cho nút "Trước"
        document.getElementById('prevButton').addEventListener('click', function() {
            if (currentIndex > 0) {
            currentIndex -= 5;
            updateChart(myChart, getKpiSlice(currentIndex));
            }
        });

        // Thêm sự kiện cho nút "Sau"
        document.getElementById('nextButton').addEventListener('click', function() {
            if (currentIndex < kpiData.length - 5) {
            currentIndex += 5;
            updateChart(myChart, getKpiSlice(currentIndex));
            }
        });
        });

        const canvas = document.getElementById('kpi-chart2');
        const context = canvas.getContext('2d');
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const radius = 70;
        const fullCircle = Math.PI * 2;
        const quarterCircle = Math.PI / 2;

        // Phần trăm KPI đã hoàn thành
        let completedPercentage = 0; // Bắt đầu từ 0%
        const finalPercentage = 75; // Đích đến là 75%

        // Vẽ hình tròn rỗng
        function drawEmptyCircle() {
        context.beginPath();
        context.arc(centerX, centerY, radius, 0, fullCircle);
        context.lineWidth = 10;
        context.strokeStyle = '#e6e6e6';
        context.stroke();
        }

        // Vẽ phần trăm KPI đã hoàn thành
        function drawCompletedCircle() {
        context.beginPath();
        context.arc(centerX, centerY, radius, -quarterCircle, (fullCircle * completedPercentage / 100) - quarterCircle);
        context.lineWidth = 10;
        context.strokeStyle = '#EA4C89'; // Màu sắc cho phần đã hoàn thành
        context.stroke();
        }

        // Vẽ phần trăm bên trong hình tròn
        function drawPercentageText() {
        context.font = '20px Arial';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(completedPercentage + '%', centerX, centerY);
        }

        // Hàm hoạt hình
        function animate() {
        context.clearRect(0, 0, canvas.width, canvas.height); // Xóa canvas trước khi vẽ lại
        drawEmptyCircle();
        drawCompletedCircle();
        drawPercentageText();

        if (completedPercentage < finalPercentage) {
            completedPercentage++; // Tăng dần phần trăm đã hoàn thành
            requestAnimationFrame(animate); // Gọi lại hàm hoạt hình
        }
        }

        animate(); // Bắt đầu hoạt hình


    </script>
    <!------------------------------------------------------End Script----------------------------------------->


</body>





</html>